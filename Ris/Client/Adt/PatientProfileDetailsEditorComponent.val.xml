<?xml version="1.0" encoding="utf-8" ?>
<specifications>

  <spec id="MrnID">
    <not-null test="$.MrnID" failMessage="MRN is required"/>
    <regex test="$.MrnID" pattern="^\d{7}$" failMessage="MRN must be 7 digits"/>
  </spec>

  <spec id="MrnSite">
    <not-null test="$.MrnSite" failMessage="MRN site is required"/>
  </spec>

  <spec id="FamilyName">
    <not-null test="$.FamilyName" failMessage="Family name is required"/>
  </spec>
  
  <spec id="GivenName">
    <not-null test="$.GivenName" failMessage="Given name is required"/>
  </spec>
  
  <spec id="HealthcardID">
    <not-null test="$.HealthcardID" failMessage="Healthcard # is required"/>
    <regex test="$.HealthcardID" pattern="^\d{10}$" failMessage="Healthcard # must be 10 digits"/>
  </spec>

  <spec id="HealthcardProvince">
    <not-null test="$.HealthcardProvince" failMessage="Healthcard province is required"/>
  </spec>

  <spec id="HealthcardVersionCode">
    <or failMessage="Version code required">
      <true test="$.HealthcardExpiryDate == null"/>
      <not-null test="$.HealthcardVersionCode"/>
    </or>
    <regex test="$.HealthcardVersionCode" pattern="\w\w" failMessage="Version code must be 2 letters"/>
  </spec>

  <spec id="HealthcardExpiryDate">
    <or failMessage="Expiry date is required">
      <true test="$.HealthcardVersionCode == null"/>
      <true test="$.HealthcardExpiryDate != null"/>
    </or>
  </spec>

  <spec id="TimeOfDeath">
    <or test="$" failMessage="Time of death cannot be earlier than date of birth">
      <null test="$.TimeOfDeath"/>
      <less-than test="$.DateOfBirth" refValue="$.TimeOfDeath"/>
    </or>
  </spec>

</specifications>
