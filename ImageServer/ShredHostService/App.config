<?xml version="1.0" encoding="utf-8" ?>
<configuration>
	<configSections>
		<section name="ShredHostServiceSettings" type="ClearCanvas.Server.ShredHost.ShredHostServiceSettings, ClearCanvas.Server.ShredHost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" allowLocation="true" allowDefinition="Everywhere" allowExeDefinition="MachineToApplication" restartOnExternalChanges="true" requirePermission="true" />
		<sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
			<section name="ClearCanvas.ImageServer.Services.Shreds.ImageServerServicesShredSettings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
			<section name="ClearCanvas.ImageServer.Services.WorkQueue.WorkQueueSettings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
			<section name="ClearCanvas.ImageServer.Services.WorkQueue.StudyProcess.StudyProcessSettings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
			<section name="ClearCanvas.ImageServer.Services.Streaming.HeaderRetrieval.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
			<section name="ClearCanvas.ImageServer.Services.Shreds.StreamingServer.StreamingServer" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />

		</sectionGroup>
	</configSections>

	<ShredHostServiceSettings ShredHostHttpPort="50220" SharedHttpPort="50221" SharedTcpPort="50222" />
	<system.serviceModel>
		<bindings>
			<wsHttpBinding>
				<binding name="WSHttpBinding_IHeaderRetrievalService" closeTimeout="00:01:00" 
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                    messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true"
                    allowCookies="false">
					<readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
					<reliableSession ordered="true" inactivityTimeout="00:10:00"
                        enabled="false" />
					<security mode="Message">
						<transport clientCredentialType="Windows" proxyCredentialType="None"
                            realm="" />
						<message clientCredentialType="Windows" negotiateServiceCredential="true"
                            algorithmSuite="Default" establishSecurityContext="true" />
					</security>
				</binding>
			</wsHttpBinding>
			<netTcpBinding>
				<binding name="NetTcpBinding_IHeaderRetrievalService" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
                    hostNameComparisonMode="StrongWildcard" listenBacklog="10"
                    maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10"
                    maxReceivedMessageSize="65536">
					<readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
					<reliableSession ordered="true" inactivityTimeout="00:10:00"
                        enabled="false" />
					<security mode="Message">
						<transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
						<message clientCredentialType="Windows" />
					</security>
				</binding>
			</netTcpBinding>
		</bindings>
		<client>
		</client>
		<services>			
		</services>
		<behaviors>
			<serviceBehaviors>
				<behavior name="serviceBehavior">
					<serviceAuthorization
			impersonateCallerForAllOperations="false"/>
					<serviceCredentials>
						<windowsAuthentication allowAnonymousLogons="false"
			  includeWindowsGroups="true" />
					</serviceCredentials>
				</behavior>
			</serviceBehaviors>
		</behaviors>
	</system.serviceModel>

	<connectionStrings>
		<clear/>
		<add name="ImageServerConnectString"
		  connectionString="Data Source=127.0.0.1;User ID=sa;Password=clearcanvas;Initial Catalog=ImageServer"
		  providerName="System.Data.SqlClient" />
	</connectionStrings>

	<applicationSettings>		
		<ClearCanvas.ImageServer.Services.Shreds.ImageServerServicesShredSettings>
			<setting name="WorkQueueThreadCount" serializeAs="String">
				<value>5</value>
			</setting>
			<setting name="ListenIPV6" serializeAs="String">
				<value>False</value>
			</setting>
			<setting name="ListenIPV4" serializeAs="String">
				<value>True</value>
			</setting>
		</ClearCanvas.ImageServer.Services.Shreds.ImageServerServicesShredSettings>
		<ClearCanvas.ImageServer.Services.WorkQueue.WorkQueueSettings>
			<setting name="WorkQueueQueryDelay" serializeAs="String">
				<value>10000</value>
			</setting>
			<setting name="WorkQueueMaxFailureCount" serializeAs="String">
				<value>3</value>
			</setting>
			<setting name="WorkQueueFailureDelayMinutes" serializeAs="String">
				<value>3</value>
			</setting>
			<setting name="WorkQueueProcessDelaySeconds" serializeAs="String">
				<value>30</value>
			</setting>
			<setting name="WorkQueueExpireDelaySeconds" serializeAs="String">
				<value>90</value>
			</setting>
		</ClearCanvas.ImageServer.Services.WorkQueue.WorkQueueSettings>
		<ClearCanvas.ImageServer.Services.WorkQueue.StudyProcess.StudyProcessSettings>
			<setting name="LogStatistics" serializeAs="bool">
				<value>True</value>
			</setting>
		</ClearCanvas.ImageServer.Services.WorkQueue.StudyProcess.StudyProcessSettings>

		<ClearCanvas.ImageServer.Services.Shreds.StreamingServer.StreamingServer>
			<setting name="BindingType" serializeAs="String">
				<!-- if http binding is used, check the settings in WSHttpBinding_IHeaderRetrievalService -->
				<!-- if tcp binding is used, check the settings in NetTcpBinding_IHeaderRetrievalService -->
				<value>http</value>
			</setting>
		</ClearCanvas.ImageServer.Services.Shreds.StreamingServer.StreamingServer>
		
		<ClearCanvas.ImageServer.Services.Streaming.HeaderRetrieval.Settings>
			<setting name="LogStatistics" serializeAs="String">
				<value>False</value>
			</setting>
			<setting name="ReadBufferSize" serializeAs="String">
				<value>65555</value>
			</setting>
		</ClearCanvas.ImageServer.Services.Streaming.HeaderRetrieval.Settings>
	</applicationSettings>

	<runtime>
		<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
			<probing privatePath="common;plugins" />
		</assemblyBinding>
	</runtime>
	
</configuration>

